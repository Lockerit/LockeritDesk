/*******************************************************************************************************************************************/

ğŸ” Asignar locker (/api/lockers/assign)

POST /api/lockers/assign

DescripciÃ³n: Activa el monedero, espera que se ingrese el valor configurado (ej: $1000), y al completarlo asigna y abre un locker.

ğŸ“¥ Body (JSON)

{
  "phone": "3001234567",
  "pin": "1234"
}

âœ… Respuesta exitosa

{
  "success": true,
  "message": "Locker asignado y abierto exitosamente",
  "lockerCode": "F10"
}
/*{
    "success": true,
    "message": "Locker asignado y abierto exitosamente",
    "lockerCode": "F10"
}*/

âŒ Errores comunes

409 Conflict â†’ No hay lockers disponibles.

401 Unauthorized â†’ Ya existe una sesiÃ³n activa para ese nÃºmero de telÃ©fono.

500 Internal Server Error â†’ Fallo del hardware.

/*******************************************************************************************************************************************/

ğŸ”“ Abrir locker para retiro (   )

POST /api/lockers/remove

DescripciÃ³n: Abre un locker previamente asignado (si coincide el telÃ©fono y el PIN).

ğŸ“¥ Body (JSON)

{
  "phone": "3001234567",
  "pin": "1234",
}

âœ… Respuesta exitosa

{
  "success": true,
  "message": "Locker abierto exitosamente",
  "lockerCode": "F10"
}
/*******************************************************************************************************************************************/

ğŸ”„ Ver todos los lockers y su estado (/api/lockers/status)

GET /api/lockers/status

DescripciÃ³n: Muestra el estado de todos los lockers configurados.

âœ… Respuesta

Status: [
  "ocupado",
  "libre",
  "Reservado",
  "Deshabilitado"
]


{
  "ocupado": 10,
  "libre": 30,
  "Reservado": 2,
  "Deshabilitado": 5,
  "status": {
    "A1": "ocupado",
    "A2": "libre",
    "B1": "libre"
  }
}
/*******************************************************************************************************************************************/

ğŸ“¦ Ver solo los disponibles (/api/lockers/available) deprecate

GET /api/lockers/availablea

DescripciÃ³n: Devuelve un listado de los lockers libres.

[
  "A2",
  "B1",
  "C3"
]
/*******************************************************************************************************************************************/

ğŸ” WebSocket del monedero (/ws/connect) la conexiÃ³n se establece desde el inicio de la aplicaciÃ³n

URL:

ws: //<IP>:8080/ws/connect

ğŸ“¥ Cliente debe:

1. Abrir conexiÃ³n WebSocket antes de hacer POST a /assign.


2. Escuchar mensajes con la estructura: {
  "total": 800,
  "completo": false,
}

Cuando completo: true, se cierra el WebSocket automÃ¡ticamente.

ğŸ“¤ El cliente no debe enviar nada por el WebSocket, solo escuchar.

/*******************************************************************************************************************************************/

ğŸ” Abrir locker por Id (/api/lockers/open)

POST /api/lockers/open

DescripciÃ³n: Abre casillero Ãºnicamente o abre y cambia estado para dejarlo libre.

ğŸ“¥ Body (JSON)

{
  "lockerCode": "A1",
}

âœ… Respuesta exitosa

{
  "success": true,
  "message": "Locker abierto exitosamente",
  "lockerCode": "A1"
}

/*******************************************************************************************************************************************/

ğŸ” Abrir locker por Id (/api/lockers/setstatus)

POST /api/lockers/setstatus

DescripciÃ³n: Abre casillero Ãºnicamente o abre y cambia estado para dejarlo libre.

ğŸ“¥ Body (JSON)

{
  "lockerCode": "A1",
  "status": "ocupado"
}

âœ… Respuesta exitosa

{
  "success": true,
  "message": "Estado cambiado exitosamente",
  "lockerCode": "A1"
}